\section{Numerical Analyses}
\label{Section 5}
Based on the stability criterion of the CACC platoon controller in Equation (\ref{Eq70})-(\ref{Eq22}) obtained in Section~\ref{Section 4}, this section carries out a numerical analysis on the stability region related to desire time gap and velocity, and a comparison with the traditional ACC controller is conducted. The corresponding simulation verification is carried out under specific parameters. And we explored the difference of stability region under different controller designs for platoon CACCs, including PF-based, PLF-based, and MPLF-based.


To conduct a specific comparative analysis of the differences between different IFTs, a specific model needs to be selected to replace the general form used above. The Intelligent Driver Model (IDM) is chosen for the following reasons. Firstly, the IDM, having only six parameters with concrete meanings, has been proven to precisely model car-following behaviors. Secondly, many studies used the IDM to model ACC and CACC vehicles\citep{chang2020analysis}\citep{li2017evaluation}, which also indicates the ability of the model to reflect operations of driving-assistant systems. The model is expressed as:
\begin{equation}
g_{n}(t)=A\left[1-\left(\frac{v_{n}(t)}{v_{f}}\right)^{\delta}-\left(\frac{s_{0}+T_{n} v_{n}(t)+\frac{v_{n}(t) \Delta v_{n}(t)}{2 \sqrt{A b}}}{s_{n}(t)-l_{n}}\right)^{2}\right],
\label{Eq23}
\end{equation}
where $g_n (t)$ is the acceleration; A denotes the maximum desired acceleration; $v_n (t)$ is the velocity; $v_f$ is the free-flow velocity; $\delta$ is the acceleration component ($\delta>0$); $s_0$ is the minimum safety distance; $T_n$ is the safety time headway; $\Delta v_n (t)$ is the velocity difference between the subject vehicle and the preceding vehicle; $b_i$ is the absolute maximum desired deceleration; $s_n (t)$ is the space headway between the preceding and the subject vehicle; and $l_n$ is the length of the vehicle. The parameters are shown in Table.\ref{Table1},\citep{kesting2008adaptive}\citep{kesting2007jam} which are based on previous studies.

\begin{table}
\centering
\setlength{\abovecaptionskip}{0pt}
\setlength{\belowcaptionskip}{10pt}%设置标题与表格的距离
\caption{Parameters chosen for IDM.}
\resizebox{0.5\textwidth}{!}{
{\begin{tabular}{lccccccc} \toprule
Parameter & \text A & $v_{f}$ & $\delta$ & $s_{0}$ & $T$ & $b$ & $l$ \\ \midrule Value & $1\mathrm{~m}/\mathrm{s}^{2}$ & $33.3\mathrm{~m}/\mathrm{s}$ & 4 & $2\mathrm{~m}$ & $0.1-3\mathrm{~s}$ & $2\mathrm{~m}/\mathrm{s}^{2}$ & $5\mathrm{~m}$ \\ \bottomrule
\end{tabular}}
}
\label{Table1}
\end{table}

\subsection{stability region of CACC controller}
\subsubsection{Margin stable curves of different IFTs}
\label{Section 5.1.1}
The basic principle of controller design is that a controller can keep string stable, so it is necessary to compare the margin stable curves of the three IFTs that can keep the string stable to get the margin stable time gap which is directly related to the traffic capacity. From this perspective, we need to obtain the corresponding critical stability conditions for different IFTs.


Assuming the information from the leader and preceding vehicle is of equal importance, the $\gamma_p$ is set equal to $\gamma_l$ in this study. In addition, the weighting coefficient of communication gain of different IFTs is all set to 0.3 to make them comparable. Based on the string stability criterion of different IFTs in Equation (\ref{Eq70})-(\ref{Eq22}), the margin stable curves in the space (velocity-desire time gap) are expressed in Fig.~\ref{Figure3}. When the traffic flow environment is above the margin stable curve, it is string stable at equilibrium state, while the opposite represents the unstable traffic flow.

\begin{figure}
\centering
\includegraphics[width=9cm]{fig3.png}
\caption{~The phase diagram in the velocity-desire time gap of different IFTs.} 
\label{Figure3}
\end{figure}

It can be seen from Fig.~\ref{Figure3} that the curve of PF will have a significant unstable peak while the curve of PLF can significantly suppress the appearance of this peak under similar parameter settings to maintain a lower desire time gap in the entire velocity range. In addition, the curve of PLF is significantly lower than the curve of PF, and the critical desire time gap is only $39.04\%$ of PF when velocity = $10m/s$. This indicates that the controller based on PLF can significantly improve the stability of traffic flow compared with that on PF on enhancing traffic flow capacity and safety.

As for the margin stable curve of MPLF, it is lower than the curve of PLF, which means that obtaining more information from the preceding vehicles can improve the stability of traffic flow. More communication requirements are needed for MPLF to achieve a smaller desire time gap, but the $34\%$ reduction in the desire time gap will bring a surge in communication requirements that is difficult to achieve. According to corresponding research\citep{hafeez2013performance}, the failure rate of communication is $16\%$ when the communication frequency is 2 packet/s, and when the communication frequency is 5 packet/s, the failure rate is $38\%$. This indicates that as the communication demand in the same channel approaches the channel bandwidth, the communication failures will significantly increase. Therefore, the gain of the CACC platoon controller based on MPLF for the desire time gap and its negative impact on communication instability should be considered balanced. In contrast, the communication of PLF can significantly reduce the desire time gap on maintaining communication stability.


\subsubsection{Margin stable curves of PLF under different parameters}
\label{Section 5.1.2}
In Section~\ref{Section 5.1.1}, PLF is more adaptable in the current technical environment, which leads to another problem: how to set the weighting coefficient of communication gain. For this purpose, the numerical analysis of the different parameter settings is also carried out as follows. Derived from Equation~\ref{Eq70}, the margin stable curves in the space (velocity-desire time gap) are expressed in Fig.~\ref{Figure4}.

\begin{figure}
\includegraphics[width=9cm]{fig4.png}
\caption{~The phase diagram in the velocity-desire time gap.} 
\label{Figure4}
\end{figure}

It can be clearly found in Fig.~\ref{Figure4}, the margin stable curves of ACC and IDM are of distinct orders of magnitude compared with that of PLF under different parameter settings. For the CACC platoon controller based on PLF, it can be found that the margin stable curves are significantly lower than the ACC curve and are lower as $\gamma_p$ and $\gamma_l$ increases, which means obtaining the information from the preceding vehicle via communication can significantly improve the long-wave stability of traffic flow. From another perspective, the curve of ACC will have a significant peak as the velocity increases, which means that in the 15-30 m/s velocity range, ACC needs a larger time gap to maintain stability, while the CACC platoon based on PLF can also suppress this peak even when $\gamma_p$ and $\gamma_l$ are set to 0.1 to ensure that a low time gap can be maintained over the entire velocity range. However, with the $\gamma_p$ and $\gamma_l$ increasing, the curves show a trend of getting closer, and the control of the vehicle will tend to follow the control strategy of the preceding vehicle rather than use its own, which means that the controller is more unsafe. For the reasons above, a more significant value of $\gamma_p$ and $\gamma_l$ is not necessary for the improvement of string stability, so we choose $\gamma_p=\gamma_l=0.3$ in the following simulations.

\subsection{Simulation validation}
\label{Section 5.2}
To verify the results of theoretical numerical analysis from the perspective of short-wave stability of traffic flow, the response of the CACC platoon under disturbance is analyzed under open boundary conditions. The simulation scenario is as follows: the simulation platoon includes an MV as the leader vehicle and five CACCs. The CACC following the MV degenerates to ACC, and other vehicles use the general model as the longitudinal control model. At first, all vehicles maintain the same initial velocity of 10m/s and the desire time gap. The form of disturbance is the leader vehicle MV suddenly accelerates to 11.8m/s in 5s and keeps the velocity for 15s. The MV then decelerates back to 8.2m/s and accelerates back to 11.8m/s, while the following vehicles respond to this traffic oscillation scenario. The simulations are carried out by increasing desired time gap $t_a$ from 0.1s to 0.6s. Fig.~\ref{Figure5}-\ref{Figure6} show the time evolutions of the velocity and acceleration of the simulation platoon for the parameter $t_a=0.1,0.3,0.4,0.6s$.

\begin{figure}
\includegraphics[width=9cm]{fig5.png}
\caption{~Time evolutions of the velocity of the simulation platoon for the parameter $t_a=0.1,0.3,0.4,0.6s$.} 
\label{Figure5}
\end{figure}

\begin{figure}
\includegraphics[width=9cm]{fig6.png}
\caption{~Time evolutions of the acceleration of the simulation platoon for the parameter $t_a=0.1,0.3,0.4,0.6s$.} 
\label{Figure6}
\end{figure}

From Fig.~\ref{Figure5}-\ref{Figure6}, we can clearly find that with the increase of the desire time gap $t_a$, the traffic oscillation generated by the sudden accelerating and decelerating of the leader vehicle MV gradually weakened in the CACC platoon. When $t_a=0.1,0.3,0.4s$, the disturbance increase propagates downstream with time as shown in Fig.~\ref{Figure5}-\ref{Figure6}, which indicates the CACC platoon is string instability, while the disturbance is gradually suppressed as it propagates downstream for $t_a=0.6s$. The above results show that the theoretical results of linear stability analysis agree with those of the simulation of short-wave stability.

\subsection{Comparisons between different IFTs}
In addition to the differences in stability region explored in Section~\ref{Section 5.1.1}, the difference of IFTs on robustness, safety, and emission is investigated based on numerical simulation, which is difficult to reflect in the numerical analysis. Many existing studies\citep{gong2016constrained}\citep{li2014stop} used traffic oscillation scenarios to compare the performance of different vehicle types, which is highly effective. Therefore, we continue to use this method for simulation, and the specific simulation scenario is similar to the one in 5.2.

\subsubsection{Comparison of robustness}

In practical application, packet loss and cyber-attack make the communication environment not absolutely ideal, making it necessary to ensure the robustness of the corresponding IFTs. To verify the robustness of different IFTs, we simulated the CACC platoon equipped with different IFTs in a non-ideal communication environment with 10\% packet loss rate and 10Hz communication frequency. IFT parameter settings similar to those in Section~\ref{Section 5.2} are applied in the simulation. The simulation results are shown in Fig.~\ref{Figure7}.

\begin{figure}
\includegraphics[width=9cm]{fig7.png}
\caption{~Time evolutions of the velocity and acceleration of simulation platoon for different IFTs.} 
\label{Figure7}
\end{figure}

Packet loss rate appears as a sudden increase or decrease of the acceleration in Fig.~\ref{Figure7}. Admittedly, poor communication quality can significantly affect the stability of the CACC platoon, especially in continuous packet loss. However, due to high communication frequency, the velocity curves of PF and PLF remain steady. At the same time, few disturbances on accelerations show that platoon controllers designed based on PF and PLF are robust against such communication failures. They can still guarantee smooth driving even under poor communication quality. On the other hand, platoon controllers designed based on MPLF are not robust against such communication failures and will experience significant velocity fluctuations due to its dependence on ideal communication. Therefore, PF and PLF are more suitable IFTs in terms of robustness.


\subsubsection{Comparison of traffic safety}


In addition to stability, safety is another essential reference factor for controller design. Several indicators such as TTC, MTTC, PET, DRAC are selected to compare the security performance of platoon controllers based on different IFTs. Table.\ref{Table2} provides the definition and calculation formula for each indicator where $x_{L,t}$ and $x_{F,t}$ denotes the positions of the leading vehicle and the following vehicle at time t, respectively; $v_{F,t}$ and $v_{L,t}$ are their velocities at time t; $D_L$ is the length of the leading vehicle; $\Delta a_t$ is the relative acceleration of conflicting vehicles at time t; $t_{F,t}$ and $t_{L,t}$ are the time of following vehicle arrives and leading vehicle leaves encroachment time. Simulation is implemented based on similar IFT parameter settings in Section~\ref{Section 5.2}. Fig.~\ref{Figure8} shows the improvement rate of different IFTs compared with pure MV environment as the baseline on various indicators. It should be noted that the TTC and MTTC are the larger, the safer, while the DRAC is the smaller, the safer. Therefore, the improvement rate mentioned here refers to the growth rate of IFT compared to MV for TTC and MTTC, while it represents the reduction rate for DRAC.
\begin{table}\large
    \centering
    \setlength{\abovecaptionskip}{0pt}
    \setlength{\belowcaptionskip}{10pt}%设置标题与表格的距离
    \caption{~Definitions and formulas of indicators used to evaluate safety.}
    \resizebox{0.5\textwidth}{!}{
    \renewcommand\arraystretch{1.5}
        \begin{tabular}{|c|c|c|}
        \hline  & Definition & Calculation formulas \\
        \hline TTC  & Time To Collision &  $T T C_{t}=\frac{x_{L, t}-x_{F, t}-D_{L}}{v_{F, t}-v_{L, t}} ; \forall\left(v_{F, t}-v_{L, t}\right)>0$\\
        \hline \multirow{2}{*}{MTTC} & \multirow{2}{*}{Maximum Time To Collision} & 
        \multicolumn{1}{|l|}{$MTTC_{t}=$}\\
        &&\multicolumn{1}{|c|}{$\frac{v_{F, t}-v_{L, t} \pm \sqrt{\left(v_{F, t}-v_{L, t}\right)^{2}+2 \Delta a_{t}\left(x_{L, t}-x_{F, t}-D_{L}\right)}}{\Delta a_{t}}$}\\
        \hline DRAC & Deceleration Rate to Avoid the Crash & 
        \multicolumn{1}{|l|}{$DRAC_{F, t}=\frac{\left(v_{F, t}-v_{L, t}\right)^{2}}{2\left(x_{L, t}-x_{F, t}-D_{L}\right)}$}\\
        \hline
        \end{tabular}
    }
\label{Table2}
\end{table}

\begin{figure}
\includegraphics[width=9cm]{fig8.png}
\caption{~Improvement rate of indicators among three IFTs against pure MV.} 
\label{Figure8}
\end{figure}

It can be found from Fig.~\ref{Figure8} that the application of CACC can significantly improve safety compared to purely manual driving no matter what IFT is used. However, the impact of different IFTs on safety indicators is distinct. For example, adopting PLF or MPLF can cause nearly twice the optimization effect compared to PF, while the difference between PLF and MPLF is tiny. When we pay attention to the difference between PLF and MPLF, we can find that PLF can still maintain a certain advantage compared to MPLF which may b e due to the excessive dependence of MPLF on the information from the preceding vehicle. In general, PLF is the best among the three IFTs from the perspective of safety.


A simulation experiment is also carried out with different velocities and desire time gaps to explore the change of the safety indicators in the region of velocity-desire time gap (for simplicity, here, only the DRAC is selected as the comparison indicator). Based on the safety indicator DRAC, optimization heatmaps of three IFTs relative to MV are shown in Fig.~\ref{Figure9} where value is expressed as a percentage.

\begin{figure}
\includegraphics[width=9cm]{fig9.png}
\caption{~Improvement rate heatmap of DRAC among three IFTs against pure MV.} 
\label{Figure9}
\end{figure}

The improvement rate heatmaps of the three IFTs all show a trend that the improvement rate first increases and then decreases as the velocity increases. If PLF is adopted, the improvement rate can reach 40\% and above regardless of desired time gap. From the perspective of the desire time gap, it is found that the improvement rate decreases with the increase of the desire time gap. The phenomenon may be explained by that pure MV vehicles tend to be more and more stable with the improvement of the desire time gap. At the same time, CACCs remain stable so that the relative improvement rate is getting smaller and smaller. In addition, when we focus on the differences between the three IFTs, we find that adopting PLF or MPLF can maintain a significant gain compared to PF, and PLF is better than MPLF, which is similar to the conclusion in Fig.~\ref{Figure8}.

\subsubsection{Comparison of Eco-driving}

With the substantial increase in the number of vehicles, CACCs are also considered a solution, so it is necessary for us to incorporate pollutant emissions into the comparison of different IFTs. Panis et al.\citep{panis2006modelling} established an emission model using a non-linear multivariate regression based on field measurement. The expression for calculation instantaneous traffic emission of a specific vehicle is:

\begin{small}
\begin{equation}
E_{i}(t)=\max \left[0, f_{1}\!+\!f_{2} v_{i}(t)\!+\!f_{3} v_{i}(t)^{2}\!+\!f_{4} a_{i}(t)\!+\!f_{5} a_{i}(t)^{2}\!+\!f_{6} v_{i}(t) a_{i}(t)\right],
\end{equation}
\end{small}
where $E_i (t)$ is the pollutant emission for the vehicle in unit time(g/s); $f_1$ to $f_6$ are emission parameters for each type of pollutant; $v_i (t)$ is the velocity of the subject vehicle; and $a_i (t)$ is the acceleration of the subject vehicle. Values of emission parameters are provided in Table.\ref{Table3}. The simulation scenario is the same as Section~\ref{Section 5.2}. The results of different IFTs compared with pure MV setting as the baseline are shown in Fig.~\ref{Figure10}.

\begin{table}
    \centering
    \setlength{\abovecaptionskip}{0pt}
    \setlength{\belowcaptionskip}{10pt}%设置标题与表格的距离
    \caption{~Parameters for Emission Model of Petrol Car.}
    \resizebox{0.5\textwidth}{!}{

        {\begin{tabular}{cccccccc} \toprule
        \multicolumn{2}{c}{Pollutant} & $f_{1}$ & $f_{2}$ & $f_{3}$ & $f_{4}$ & $f_{5}$ & $f_{6}$ \\ \midrule
        \multicolumn{2}{c}{$CO_{2}$} & 5.53e-01 & 1.61e-01 & -2.89e-03 & 2.66e-01 & 5.11e-01 & 1.83e-01 \\ \midrule
        \multirow{2}*{$NO_{x}$} & $a \geq-0.5 \mathrm{~m}/\mathrm{s}^{2}$ & 6.19e-04 & 8.00e-05 & -4.03e-06 & -4.13e-04 & 3.80e-04 & 1.77e-04 \\ \cmidrule{2-8} & $a<-0.5 \mathrm{~m}/\mathrm{s}^{2}$ & 2.17 e-04 & 0 & 0 & 0 & 0 & 0 \\ \midrule
        \multirow{2}*{$VOC$} & $a \geq-0.5 \mathrm{~m}/\mathrm{s}^{2}$ & 4.47e-03 & 7.32e-07 & -2.87e-08 & -3.41e-06 & 4.94e-06 & 1.66e-06 \\ \cmidrule{2-8} & $a<-0.5 \mathrm{~m}/\mathrm{s}^{2}$ & 2.63e-03 & 0 & 0 & 0 & 0 & 0 \\ \midrule
        \multicolumn{2}{c}{$PM$} & 0 & 1.57e-05 & -9.21e-07 & 0 & 3.75e-05 & 1.89e-05\\ \bottomrule
        \end{tabular}}
    }
\label{Table3}
\end{table}

\begin{figure}
\includegraphics[width=9cm]{fig10.png}
\caption{~Pollutants reduction proportion among three IFTs against pure MV.} 
\label{Figure10}
\end{figure}

From Fig.~\ref{Figure10} we can find that the CACCs can effectively reduce the emissions of various pollutants, and the magnitude of emission reduction of different emissions are also different. And different IFTs for the same pollutant can also cause significant differences. PLF and MPLF can cause a nearly 5-fold decrease in VOC relative to PF, while the impact of the three IFTs on reducing $CO_2$, PM, and $NO_x$ emissions are similar. In addition, the difference of PLF and MPLF on reducing the above four types of emissions are too negligible to distinguish which one is better compared to their volume.
\begin{figure}
\includegraphics[width=9cm]{fig11.png}
\caption{~Reduction proportion heatmap of VOC among three IFTs against pure MV.} 
\label{Figure11}
\end{figure}

When we look at the difference between different IFTs, we can find from Figure 11 that the reduction proportion improving effect of PLF and MPLF on VOC indicators is indistinguishable, while the impact of PF is less significant than the other two. Moreover, both PLF and MPLF can significantly reduce VOC in the area above the red curve, while the effect of PF in the whole area is less obvious. In addition, an interesting phenomenon can be found from figure 11 that a clear dividing line can be seen on the heatmap of all three IFTs, and the reduction proportion of the upper area of the dividing line can be significantly improved compared to that of the lower area. This phenomenon can be reasonably inferred that this boundary line is the critical line of pure MV performance degradation on VOC. The use of CAV can suppress the appearance of performance degradation, making this red line a crucial line for sudden changes in the reduction proportion. In addition, if we pay attention to the area below the red curve, we can find that the relative relationship between PF and PLF is also consistent with the conclusion in Fig.~\ref{Figure11}, while the case for PLF and MPLF are slightly different. The reduction proportion heat maps of PLF and MPLF maintain a similar trend overall, but when the desire time gap is in 0-0.3s , and the velocity is in 1-16m/s, it is obvious that PLF is better than MPLF.